{"version":3,"sources":["../../../src/ui/use-chat/useChatRuntime.tsx"],"sourcesContent":["\"use client\";\n\nimport { useChat, type UIMessage } from \"@ai-sdk/react\";\nimport type { AssistantCloud } from \"assistant-cloud\";\nimport {\n  AssistantRuntime,\n  unstable_useCloudThreadListAdapter,\n  unstable_useRemoteThreadListRuntime,\n  useAssistantState,\n} from \"@assistant-ui/react\";\nimport {\n  useAISDKRuntime,\n  type AISDKRuntimeAdapter,\n  type CustomToCreateMessageFunction,\n} from \"./useAISDKRuntime\";\nimport { ChatInit } from \"ai\";\nimport { AssistantChatTransport } from \"./AssistantChatTransport\";\n\nexport type UseChatRuntimeOptions<UI_MESSAGE extends UIMessage = UIMessage> =\n  ChatInit<UI_MESSAGE> & {\n    cloud?: AssistantCloud | undefined;\n    adapters?: AISDKRuntimeAdapter[\"adapters\"] | undefined;\n    toCreateMessage?: CustomToCreateMessageFunction;\n  };\n\nexport const useChatThreadRuntime = <UI_MESSAGE extends UIMessage = UIMessage>(\n  options?: UseChatRuntimeOptions<UI_MESSAGE>,\n): AssistantRuntime => {\n  const {\n    adapters,\n    transport: transportOptions,\n    toCreateMessage,\n    ...chatOptions\n  } = options ?? {};\n  const transport = transportOptions ?? new AssistantChatTransport();\n\n  const id = useAssistantState(({ threadListItem }) => threadListItem.id);\n  const chat = useChat({\n    ...chatOptions,\n    id,\n    transport,\n  });\n\n  const runtime = useAISDKRuntime(chat, {\n    adapters,\n    ...(toCreateMessage && { toCreateMessage }),\n  });\n\n  if (transport instanceof AssistantChatTransport) {\n    transport.setRuntime(runtime);\n  }\n\n  return runtime;\n};\n\nexport const useChatRuntime = <UI_MESSAGE extends UIMessage = UIMessage>({\n  cloud,\n  ...options\n}: UseChatRuntimeOptions<UI_MESSAGE> = {}): AssistantRuntime => {\n  const cloudAdapter = unstable_useCloudThreadListAdapter({ cloud });\n  return unstable_useRemoteThreadListRuntime({\n    runtimeHook: function RuntimeHook() {\n      return useChatThreadRuntime(options);\n    },\n    adapter: cloudAdapter,\n  });\n};\n"],"mappings":";;;AAEA,SAAS,eAA+B;AAExC;AAAA,EAEE;AAAA,EACA;AAAA,EACA;AAAA,OACK;AACP;AAAA,EACE;AAAA,OAGK;AAEP,SAAS,8BAA8B;AAShC,IAAM,uBAAuB,CAClC,YACqB;AACrB,QAAM;AAAA,IACJ;AAAA,IACA,WAAW;AAAA,IACX;AAAA,IACA,GAAG;AAAA,EACL,IAAI,WAAW,CAAC;AAChB,QAAM,YAAY,oBAAoB,IAAI,uBAAuB;AAEjE,QAAM,KAAK,kBAAkB,CAAC,EAAE,eAAe,MAAM,eAAe,EAAE;AACtE,QAAM,OAAO,QAAQ;AAAA,IACnB,GAAG;AAAA,IACH;AAAA,IACA;AAAA,EACF,CAAC;AAED,QAAM,UAAU,gBAAgB,MAAM;AAAA,IACpC;AAAA,IACA,GAAI,mBAAmB,EAAE,gBAAgB;AAAA,EAC3C,CAAC;AAED,MAAI,qBAAqB,wBAAwB;AAC/C,cAAU,WAAW,OAAO;AAAA,EAC9B;AAEA,SAAO;AACT;AAEO,IAAM,iBAAiB,CAA2C;AAAA,EACvE;AAAA,EACA,GAAG;AACL,IAAuC,CAAC,MAAwB;AAC9D,QAAM,eAAe,mCAAmC,EAAE,MAAM,CAAC;AACjE,SAAO,oCAAoC;AAAA,IACzC,aAAa,SAAS,cAAc;AAClC,aAAO,qBAAqB,OAAO;AAAA,IACrC;AAAA,IACA,SAAS;AAAA,EACX,CAAC;AACH;","names":[]}