{"version":3,"sources":["../../../../src/legacy-runtime/runtime-cores/external-store/auto-status.tsx"],"sourcesContent":["import { ReadonlyJSONValue } from \"assistant-stream/utils\";\nimport { MessageStatus } from \"../../../types\";\n\nconst symbolAutoStatus = Symbol(\"autoStatus\");\n\nconst AUTO_STATUS_RUNNING = Object.freeze(\n  Object.assign({ type: \"running\" as const }, { [symbolAutoStatus]: true }),\n);\nconst AUTO_STATUS_COMPLETE = Object.freeze(\n  Object.assign(\n    {\n      type: \"complete\" as const,\n      reason: \"unknown\" as const,\n    },\n    { [symbolAutoStatus]: true },\n  ),\n);\n\nconst AUTO_STATUS_PENDING = Object.freeze(\n  Object.assign(\n    {\n      type: \"requires-action\" as const,\n      reason: \"tool-calls\" as const,\n    },\n    { [symbolAutoStatus]: true },\n  ),\n);\n\nconst AUTO_STATUS_INTERRUPT = Object.freeze(\n  Object.assign(\n    {\n      type: \"requires-action\" as const,\n      reason: \"interrupt\" as const,\n    },\n    { [symbolAutoStatus]: true },\n  ),\n);\n\nexport const isAutoStatus = (status: MessageStatus) =>\n  (status as any)[symbolAutoStatus] === true;\n\nexport const getAutoStatus = (\n  isLast: boolean,\n  isRunning: boolean,\n  hasInterruptedToolCalls: boolean,\n  hasPendingToolCalls: boolean,\n  error?: ReadonlyJSONValue,\n): MessageStatus => {\n  if (isLast && error) {\n    return Object.assign(\n      {\n        type: \"incomplete\" as const,\n        reason: \"error\" as const,\n        error: error,\n      },\n      { [symbolAutoStatus]: true },\n    );\n  }\n\n  return isLast && isRunning\n    ? AUTO_STATUS_RUNNING\n    : hasInterruptedToolCalls\n      ? AUTO_STATUS_INTERRUPT\n      : hasPendingToolCalls\n        ? AUTO_STATUS_PENDING\n        : AUTO_STATUS_COMPLETE;\n};\n"],"mappings":";AAGA,IAAM,mBAAmB,OAAO,YAAY;AAE5C,IAAM,sBAAsB,OAAO;AAAA,EACjC,OAAO,OAAO,EAAE,MAAM,UAAmB,GAAG,EAAE,CAAC,gBAAgB,GAAG,KAAK,CAAC;AAC1E;AACA,IAAM,uBAAuB,OAAO;AAAA,EAClC,OAAO;AAAA,IACL;AAAA,MACE,MAAM;AAAA,MACN,QAAQ;AAAA,IACV;AAAA,IACA,EAAE,CAAC,gBAAgB,GAAG,KAAK;AAAA,EAC7B;AACF;AAEA,IAAM,sBAAsB,OAAO;AAAA,EACjC,OAAO;AAAA,IACL;AAAA,MACE,MAAM;AAAA,MACN,QAAQ;AAAA,IACV;AAAA,IACA,EAAE,CAAC,gBAAgB,GAAG,KAAK;AAAA,EAC7B;AACF;AAEA,IAAM,wBAAwB,OAAO;AAAA,EACnC,OAAO;AAAA,IACL;AAAA,MACE,MAAM;AAAA,MACN,QAAQ;AAAA,IACV;AAAA,IACA,EAAE,CAAC,gBAAgB,GAAG,KAAK;AAAA,EAC7B;AACF;AAEO,IAAM,eAAe,CAAC,WAC1B,OAAe,gBAAgB,MAAM;AAEjC,IAAM,gBAAgB,CAC3B,QACA,WACA,yBACA,qBACA,UACkB;AAClB,MAAI,UAAU,OAAO;AACnB,WAAO,OAAO;AAAA,MACZ;AAAA,QACE,MAAM;AAAA,QACN,QAAQ;AAAA,QACR;AAAA,MACF;AAAA,MACA,EAAE,CAAC,gBAAgB,GAAG,KAAK;AAAA,IAC7B;AAAA,EACF;AAEA,SAAO,UAAU,YACb,sBACA,0BACE,wBACA,sBACE,sBACA;AACV;","names":[]}