{"version":3,"sources":["../../../src/context/providers/MessageByIndexProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport {\n  AssistantProvider,\n  useAssistantApi,\n  useExtendedAssistantApi,\n} from \"../react/AssistantApiContext\";\nimport {\n  checkEventScope,\n  normalizeEventSelector,\n} from \"../../types/EventTypes\";\nimport { DerivedScope } from \"../../utils/tap-store/derived-scopes\";\n\nexport const MessageByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n  }>\n> = ({ index, children }) => {\n  const baseApi = useAssistantApi();\n  const api = useExtendedAssistantApi({\n    message: DerivedScope({\n      source: \"thread\",\n      query: { type: \"index\", index },\n      get: () => baseApi.thread().message({ index }),\n    }),\n    composer: DerivedScope({\n      source: \"message\",\n      query: {},\n      get: () => baseApi.thread().message({ index }).composer,\n    }),\n    on(selector, callback) {\n      const getMessage = () => baseApi.thread().message({ index });\n      const { event, scope } = normalizeEventSelector(selector);\n      if (\n        !checkEventScope(\"composer\", scope, event) &&\n        !checkEventScope(\"message\", scope, event)\n      )\n        return baseApi.on(selector, callback);\n\n      return baseApi.on({ scope: \"thread\", event }, (e) => {\n        if (e.messageId === getMessage().getState().id) {\n          callback(e);\n        }\n      });\n    },\n  });\n\n  return <AssistantProvider api={api}>{children}</AssistantProvider>;\n};\n"],"mappings":";;;AAGA;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA;AAAA,OACK;AACP,SAAS,oBAAoB;AAoCpB;AAlCF,IAAM,yBAIT,CAAC,EAAE,OAAO,SAAS,MAAM;AAC3B,QAAM,UAAU,gBAAgB;AAChC,QAAM,MAAM,wBAAwB;AAAA,IAClC,SAAS,aAAa;AAAA,MACpB,QAAQ;AAAA,MACR,OAAO,EAAE,MAAM,SAAS,MAAM;AAAA,MAC9B,KAAK,MAAM,QAAQ,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC;AAAA,IAC/C,CAAC;AAAA,IACD,UAAU,aAAa;AAAA,MACrB,QAAQ;AAAA,MACR,OAAO,CAAC;AAAA,MACR,KAAK,MAAM,QAAQ,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,EAAE;AAAA,IACjD,CAAC;AAAA,IACD,GAAG,UAAU,UAAU;AACrB,YAAM,aAAa,MAAM,QAAQ,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC;AAC3D,YAAM,EAAE,OAAO,MAAM,IAAI,uBAAuB,QAAQ;AACxD,UACE,CAAC,gBAAgB,YAAY,OAAO,KAAK,KACzC,CAAC,gBAAgB,WAAW,OAAO,KAAK;AAExC,eAAO,QAAQ,GAAG,UAAU,QAAQ;AAEtC,aAAO,QAAQ,GAAG,EAAE,OAAO,UAAU,MAAM,GAAG,CAAC,MAAM;AACnD,YAAI,EAAE,cAAc,WAAW,EAAE,SAAS,EAAE,IAAI;AAC9C,mBAAS,CAAC;AAAA,QACZ;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AAED,SAAO,oBAAC,qBAAkB,KAAW,UAAS;AAChD;","names":[]}