{"version":3,"sources":["../../../src/context/providers/ThreadListItemProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport {\n  AssistantProvider,\n  useAssistantApi,\n  useExtendedAssistantApi,\n} from \"../react/AssistantApiContext\";\nimport {\n  checkEventScope,\n  normalizeEventSelector,\n} from \"../../types/EventTypes\";\nimport { DerivedScope } from \"../../utils/tap-store/derived-scopes\";\n\nexport const ThreadListItemByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n    archived: boolean;\n  }>\n> = ({ index, archived, children }) => {\n  const baseApi = useAssistantApi();\n\n  const api = useExtendedAssistantApi({\n    threadListItem: DerivedScope({\n      source: \"threads\",\n      query: { type: \"index\", index, archived },\n      get: () => baseApi.threads().item({ index, archived }),\n    }),\n    on(selector, callback) {\n      const getItem = () => baseApi.threads().item({ index, archived });\n      const { event, scope } = normalizeEventSelector(selector);\n      if (!checkEventScope(\"thread-list-item\", scope, event))\n        return baseApi.on(selector, callback);\n\n      return baseApi.on({ scope: \"*\", event }, (e) => {\n        if (e.threadId === getItem().getState().id) {\n          callback(e);\n        }\n      });\n    },\n  });\n\n  return <AssistantProvider api={api}>{children}</AssistantProvider>;\n};\n\nexport const ThreadListItemByIdProvider: FC<\n  PropsWithChildren<{\n    id: string;\n  }>\n> = ({ id, children }) => {\n  const baseApi = useAssistantApi();\n\n  const api = useExtendedAssistantApi({\n    threadListItem: DerivedScope({\n      source: \"threads\",\n      query: { type: \"id\", id },\n      get: () => baseApi.threads().item({ id }),\n    }),\n    on(selector, callback) {\n      const getItem = () => baseApi.threads().item({ id });\n      const { event, scope } = normalizeEventSelector(selector);\n      if (!checkEventScope(\"thread-list-item\", scope, event))\n        return baseApi.on(selector, callback);\n\n      return baseApi.on({ scope: \"*\", event }, (e) => {\n        if (e.threadId !== getItem().getState().id) return;\n        callback(e);\n      });\n    },\n  });\n\n  return <AssistantProvider api={api}>{children}</AssistantProvider>;\n};\n"],"mappings":";;;AAGA;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA;AAAA,OACK;AACP,SAAS,oBAAoB;AA8BpB;AA5BF,IAAM,gCAKT,CAAC,EAAE,OAAO,UAAU,SAAS,MAAM;AACrC,QAAM,UAAU,gBAAgB;AAEhC,QAAM,MAAM,wBAAwB;AAAA,IAClC,gBAAgB,aAAa;AAAA,MAC3B,QAAQ;AAAA,MACR,OAAO,EAAE,MAAM,SAAS,OAAO,SAAS;AAAA,MACxC,KAAK,MAAM,QAAQ,QAAQ,EAAE,KAAK,EAAE,OAAO,SAAS,CAAC;AAAA,IACvD,CAAC;AAAA,IACD,GAAG,UAAU,UAAU;AACrB,YAAM,UAAU,MAAM,QAAQ,QAAQ,EAAE,KAAK,EAAE,OAAO,SAAS,CAAC;AAChE,YAAM,EAAE,OAAO,MAAM,IAAI,uBAAuB,QAAQ;AACxD,UAAI,CAAC,gBAAgB,oBAAoB,OAAO,KAAK;AACnD,eAAO,QAAQ,GAAG,UAAU,QAAQ;AAEtC,aAAO,QAAQ,GAAG,EAAE,OAAO,KAAK,MAAM,GAAG,CAAC,MAAM;AAC9C,YAAI,EAAE,aAAa,QAAQ,EAAE,SAAS,EAAE,IAAI;AAC1C,mBAAS,CAAC;AAAA,QACZ;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AAED,SAAO,oBAAC,qBAAkB,KAAW,UAAS;AAChD;AAEO,IAAM,6BAIT,CAAC,EAAE,IAAI,SAAS,MAAM;AACxB,QAAM,UAAU,gBAAgB;AAEhC,QAAM,MAAM,wBAAwB;AAAA,IAClC,gBAAgB,aAAa;AAAA,MAC3B,QAAQ;AAAA,MACR,OAAO,EAAE,MAAM,MAAM,GAAG;AAAA,MACxB,KAAK,MAAM,QAAQ,QAAQ,EAAE,KAAK,EAAE,GAAG,CAAC;AAAA,IAC1C,CAAC;AAAA,IACD,GAAG,UAAU,UAAU;AACrB,YAAM,UAAU,MAAM,QAAQ,QAAQ,EAAE,KAAK,EAAE,GAAG,CAAC;AACnD,YAAM,EAAE,OAAO,MAAM,IAAI,uBAAuB,QAAQ;AACxD,UAAI,CAAC,gBAAgB,oBAAoB,OAAO,KAAK;AACnD,eAAO,QAAQ,GAAG,UAAU,QAAQ;AAEtC,aAAO,QAAQ,GAAG,EAAE,OAAO,KAAK,MAAM,GAAG,CAAC,MAAM;AAC9C,YAAI,EAAE,aAAa,QAAQ,EAAE,SAAS,EAAE,GAAI;AAC5C,iBAAS,CAAC;AAAA,MACZ,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AAED,SAAO,oBAAC,qBAAkB,KAAW,UAAS;AAChD;","names":[]}